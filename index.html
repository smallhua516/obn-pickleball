<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>场地配色预览系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
        }

        body {
            background: #ffffff;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .title-top {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
        }

        .page-title {
            font-size: 38px;
            color: #1e3a5f;
            font-weight: 700;
            margin-bottom: 0;
            letter-spacing: 2px;
            line-height: 1;
        }

        .title-logo {
            height: 55px;
            width: auto;
            object-fit: contain;
            vertical-align: middle;
        }

        /* 场地类型切换按钮组 - 放大按钮文字和图标 */
        .court-type-switch {
            display: flex;
            gap: 15px;
            padding: 8px;
            background: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .switch-btn {
            padding: 12px 30px; /* 增大内边距 */
            border-radius: 8px;
            border: none;
            background: transparent;
            font-size: 18px; /* 增大字体大小 */
            font-weight: 600;
            color: #4a5568;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px; /* 增大图标和文字间距 */
        }

        .switch-btn .btn-icon {
            width: 24px; /* 增大图标尺寸 */
            height: 24px;
            object-fit: contain;
        }

        .switch-btn.active {
            background: #2d8cf0;
            color: #ffffff;
            box-shadow: 0 4px 12px rgba(45, 140, 240, 0.2);
        }

        /* 主体内容区 */
        .main-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 280px; 
            gap: 30px;
            margin-bottom: 40px; /* 为底部上传区留出空间 */
        }

        /* 左侧预览区 */
        .preview-card {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.09);
            padding: 30px;
            height: fit-content;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .preview-title {
            font-size: 18px;
            color: #2d3748;
            margin-bottom: 25px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .preview-title::before {
            content: "";
            display: block;
            width: 4px;
            height: 18px;
            background: #2d8cf0;
            border-radius: 2px;
        }

        .court-container {
            width: 100%;
            height: 600px;
            position: relative;
            background: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.04);
            overflow: hidden;
        }

        /* Canvas与背景图分层样式 */
        #pickleLeftCanvas, #pickleRightCanvas, #pickleBufferCanvas,
        #badmintonLeftCanvas, #badmintonRightCanvas,
        #pingpongFloorCanvas, #pingpongTableCanvas,
        #basketballBufferCanvas, #basketballHomeCanvas, #basketballForbiddenCanvas,
        #basketballThreePointCanvas, #basketballSemicircleCanvas, #basketballCenterCircleCanvas { /* 新增：三个篮球区域Canvas */
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            image-rendering: crisp-edges;
            z-index: 2;
            transform: none;
            object-fit: contain;
            display: none;
        }

        /* 默认显示匹克球Canvas */
        #pickleLeftCanvas { z-index: 2; display: block; }
        #pickleRightCanvas { z-index: 3; display: block; }
        #pickleBufferCanvas { z-index: 4; display: block; }

        .court-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://s41.ax1x.com/2026/01/03/pZUwrTI.png');
            background-size: contain;
            background-position: center center;
            background-repeat: no-repeat;
            z-index: 1;
        }

        /* 右侧功能区 - 核心修改：添加滚动条并固定高度 */
        .control-card {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.09);
            padding: 60px 25px 20px;
            height: 700px; /* 固定高度，不再使用min-height */
            max-height: 700px; /* 确保高度固定 */
            overflow-y: auto; /* 垂直滚动 */
            overflow-x: hidden; /* 隐藏水平滚动 */
            border: 1px solid rgba(0, 0, 0, 0.05);
            width: 280px;
            /* 美化滚动条 */
            scrollbar-width: thin;
            scrollbar-color: #2d8cf0 #f8fafc;
        }

        /* 美化Chrome等webkit浏览器的滚动条 */
        .control-card::-webkit-scrollbar {
            width: 6px;
        }

        .control-card::-webkit-scrollbar-track {
            background: #f8fafc;
            border-radius: 3px;
            margin: 10px 0;
        }

        .control-card::-webkit-scrollbar-thumb {
            background: #2d8cf0;
            border-radius: 3px;
        }

        .control-card::-webkit-scrollbar-thumb:hover {
            background: #1c7ed6;
        }

        .control-title {
            font-size: 18px;
            color: #2d3748;
            margin-bottom: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f0f4f8;
            position: sticky; /* 标题粘性定位，滚动时保持可见 */
            top: 0;
            background: #ffffff;
            padding-top: 10px;
            z-index: 10;
        }

        .control-title::before {
            content: "";
            display: block;
            width: 4px;
            height: 18px;
            background: #2d8cf0;
            border-radius: 2px;
        }

        /* 颜色配置模块切换 */
        .pickle-color-modules { display: block; }
        .badminton-color-modules { display: none; }
        .pingpong-color-modules { display: none; }
        .basketball-color-modules { display: none; }

        /* 右侧颜色配置模块通用样式 */
        .area-color-module {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f4f8;
        }

        .area-color-module:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .module-title {
            font-size: 18px;
            color: #4a5568;
            margin-bottom: 12px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .module-title span {
            display: inline-block;
            width: 14px;
            height: 14px;
            border-radius: 4px;
        }

        /* 匹克球各区域标题标识色 */
        #noVolleyTitle span { background-color: #ff9eb1; }
        #serveTitle span { background-color: #8e77d6; }
        #bufferTitle span { background-color: #848d94; }

        /* 羽毛球各区域标题标识色 */
        #badmintonLeftTitle span { background-color: #ff9eb1; }
        #badmintonRightTitle span { background-color: #8e77d6; }

        /* 乒乓球各区域标题标识色 - 同步修改默认色 */
        #pingpongFloorTitle span { background-color: #d93636; }
        #pingpongTableTitle span { background-color: #2d8cf0; }

        /* 篮球各区域标题标识色 */
        #basketballBufferTitle span { background-color: #848d94; }
        #basketballHomeTitle span { background-color: #ff9eb1; }
        #basketballForbiddenTitle span { background-color: #f53f3f; }
        #basketballThreePointTitle span { background-color: #722ed1; } /* 新增：三分线 */
        #basketballSemicircleTitle span { background-color: #13c2c2; } /* 新增：半圆区 */
        #basketballCenterCircleTitle span { background-color: #fa8c16; } /* 新增：中圈 */

        /* 预设颜色块 */
        .single-color-group {
            display: flex;
            gap: 10px;
            flex-wrap: nowrap;
            margin-bottom: 15px;
            justify-content: flex-start;
        }

        .single-color-block {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .single-color-block:hover {
            transform: scale(1.08);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* 选中颜色块主题蓝色边框+发光效果 */
        .single-color-block.active {
            border-color: #2d8cf0;
            box-shadow: 0 0 0 2px rgba(45, 140, 240, 0.2);
            transform: scale(1.1);
        }

        /* 自定义颜色选择器 */
        .single-custom-color {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .single-color-picker {
            width: 120px;
            height: 30px;
            border: none;
            outline: none;
            cursor: pointer;
            background: transparent;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .single-color-code {
            font-size: 14px;
            color: #2d3748;
            font-weight: 600;
            padding: 8px 12px;
            background: #ffffff;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            min-width: 80px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        }

        /* 底部图片上传区域 */
        .upload-section {
            max-width: 1400px;
            margin: 0 auto 40px;
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.09);
            padding: 30px;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .upload-title {
            font-size: 18px;
            color: #2d3748;
            margin-bottom: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-title::before {
            content: "";
            display: block;
            width: 4px;
            height: 18px;
            background: #2d8cf0;
            border-radius: 2px;
        }

        .upload-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .upload-btn-wrapper {
            position: relative;
            display: inline-block;
        }

        .upload-btn {
            padding: 12px 30px;
            background: #2d8cf0;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-btn:hover {
            background: #1c7ed6;
            box-shadow: 0 4px 12px rgba(45, 140, 240, 0.3);
        }

        .upload-btn .upload-icon {
            width: 20px;
            height: 20px;
        }

        #imageUpload {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .upload-preview {
            width: 100%;
            min-height: 150px;
            background: #f8fafc;
            border-radius: 12px;
            border: 2px dashed #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .upload-preview-placeholder {
            color: #94a3b8;
            font-size: 16px;
            text-align: center;
            padding: 20px;
        }

        .uploaded-image {
            max-width: 100%;
            max-height: 400px;
            object-fit: contain;
            display: none;
        }

        /* 响应式适配 */
        @media (max-width: 992px) {
            .main-wrapper {
                grid-template-columns: 1fr;
                gap: 25px;
            }

            .control-card {
                width: 100%;
                max-width: 280px;
                margin: 0 auto;
                height: 500px; /* 响应式调整高度 */
                max-height: 500px;
            }

            .court-container {
                height: 450px;
            }

            .page-title {
                font-size: 32px;
            }
            .title-logo {
                height: 48px;
            }

            .single-color-block {
                width: 28px;
                height: 28px;
            }

            .single-color-picker {
                width: 100px;
                height: 28px;
            }

            .switch-btn {
                padding: 10px 25px; /* 响应式调整 */
                font-size: 16px; /* 响应式调整 */
            }
            
            .switch-btn .btn-icon {
                width: 22px; /* 响应式调整 */
                height: 22px;
            }

            .upload-section {
                padding: 20px;
            }

            .upload-btn {
                padding: 10px 20px;
                font-size: 14px;
            }
        }

        @media (max-width: 768px) {
            .court-container {
                height: 400px;
            }

            .page-title {
                font-size: 28px;
            }
            .title-logo {
                height: 42px;
            }

            .preview-card, .control-card {
                padding: 15px 20px;
            }

            .control-card {
                height: 450px; /* 响应式调整高度 */
                max-height: 450px;
                max-width: 260px;
            }

            .single-color-picker {
                width: 80px;
                height: 26px;
            }

            .module-title {
                font-size: 16px;
            }
            
            .switch-btn {
                padding: 8px 20px; /* 响应式调整 */
                font-size: 14px; /* 响应式调整 */
                gap: 8px;
            }
            
            .switch-btn .btn-icon {
                width: 20px; /* 响应式调整 */
                height: 20px;
            }

            .upload-title {
                font-size: 16px;
            }
        }

        /* 移动端适配四个切换按钮换行 */
        @media (max-width: 576px) {
            .court-type-switch {
                gap: 10px;
                padding: 6px;
            }
            .switch-btn {
                padding: 8px 18px;
                font-size: 13px;
            }
            .switch-btn .btn-icon {
                width: 18px;
                height: 18px;
            }

            .upload-preview {
                min-height: 100px;
            }
        }
    </style>
</head>
<body>
    <!-- 顶部标题区 -->
    <div class="page-header">
        <div class="title-top">
            <img src="https://s41.ax1x.com/2026/01/03/pZUjfv6.png" alt="欧百娜Logo" class="title-logo" onerror="this.style.display='none';">
            <h1 class="page-title">场地配色预览系统</h1>
        </div>
        <div class="court-type-switch">
            <button class="switch-btn active" data-type="pickle">
                <img src="https://s41.ax1x.com/2026/01/08/pZwfVwq.png" alt="匹克球图标" class="btn-icon">
                匹克球
            </button>
            <button class="switch-btn" data-type="badminton">
                <img src="https://s41.ax1x.com/2026/01/08/pZwfEmn.png" alt="羽毛球图标" class="btn-icon">
                羽毛球
            </button>
            <button class="switch-btn" data-type="pingpong">
                <img src="https://s41.ax1x.com/2026/01/11/pZ0jXq0.png" alt="乒乓球图标" class="btn-icon">
                乒乓球
            </button>
            <button class="switch-btn" data-type="basketball">
                <img src="https://youke3.picui.cn/s1/2026/01/11/69636a1551ca0.png" alt="篮球图标" class="btn-icon">
                篮球
            </button>
        </div>
    </div>

    <!-- 主体内容区 -->
    <div class="main-wrapper">
        <div class="preview-card">
            <h2 class="preview-title">球场效果预览</h2>
            <div class="court-container">
                <div class="court-bg"></div>
                <!-- 匹克球Canvas -->
                <canvas id="pickleLeftCanvas" width="800" height="600"></canvas>
                <canvas id="pickleRightCanvas" width="800" height="600"></canvas>
                <canvas id="pickleBufferCanvas" width="800" height="600"></canvas>
                <!-- 羽毛球Canvas -->
                <canvas id="badmintonLeftCanvas" width="800" height="600"></canvas>
                <canvas id="badmintonRightCanvas" width="800" height="600"></canvas>
                <!-- 乒乓球Canvas -->
                <canvas id="pingpongFloorCanvas" width="800" height="600"></canvas>
                <canvas id="pingpongTableCanvas" width="800" height="600"></canvas>
                <!-- 篮球Canvas -->
                <canvas id="basketballBufferCanvas" width="800" height="600"></canvas>
                <canvas id="basketballHomeCanvas" width="800" height="600"></canvas>
                <canvas id="basketballForbiddenCanvas" width="800" height="600"></canvas>
                <!-- 新增：三个篮球区域Canvas -->
                <canvas id="basketballThreePointCanvas" width="800" height="600"></canvas>
                <canvas id="basketballSemicircleCanvas" width="800" height="600"></canvas>
                <canvas id="basketballCenterCircleCanvas" width="800" height="600"></canvas>
            </div>
        </div>

        <div class="control-card">
            <h2 class="control-title">各区域独立改色控制面板</h2>

            <!-- 匹克球颜色配置模块 -->
            <div class="pickle-color-modules">
                <div class="area-color-module">
                    <h3 class="module-title" id="noVolleyTitle">
                        <span></span>
                        非截击区颜色设置
                    </h3>
                    <div class="single-color-group" data-area="pickleLeft">
                        <div class="single-color-block active" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                        <div class="single-color-block" style="background-color: #ffd666;" data-color="#ffd666"></div>
                    </div>
                    <div class="single-custom-color" data-area="pickleLeft">
                        <input type="color" class="single-color-picker" data-area="pickleLeft" value="#ff9eb1">
                        <span class="single-color-code" data-area="pickleLeft">#ff9eb1</span>
                    </div>
                </div>

                <div class="area-color-module">
                    <h3 class="module-title" id="serveTitle">
                        <span></span>
                        发球区颜色设置
                    </h3>
                    <div class="single-color-group" data-area="pickleRight">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block active" style="background-color: #8e77d6;" data-color="#8e77d6"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                    </div>
                    <div class="single-custom-color" data-area="pickleRight">
                        <input type="color" class="single-color-picker" data-area="pickleRight" value="#8e77d6">
                        <span class="single-color-code" data-area="pickleRight">#8e77d6</span>
                    </div>
                </div>

                <div class="area-color-module">
                    <h3 class="module-title" id="bufferTitle">
                        <span></span>
                        缓冲区颜色设置
                    </h3>
                    <div class="single-color-group" data-area="pickleBuffer">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #8e77d6;" data-color="#8e77d6"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block active" style="background-color: #848d94;" data-color="#848d94"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                    </div>
                    <div class="single-custom-color" data-area="pickleBuffer">
                        <input type="color" class="single-color-picker" data-area="pickleBuffer" value="#848d94">
                        <span class="single-color-code" data-area="pickleBuffer">#848d94</span>
                    </div>
                </div>
            </div>

            <!-- 羽毛球颜色配置模块 -->
            <div class="badminton-color-modules">
                <div class="area-color-module">
                    <h3 class="module-title" id="badmintonLeftTitle">
                        <span></span>
                        左侧区域颜色设置
                    </h3>
                    <div class="single-color-group" data-area="badmintonLeft">
                        <div class="single-color-block active" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #327dcd;" data-color="#327dcd"></div>
                        <div class="single-color-block" style="background-color: #d98230;" data-color="#d98230"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #0b7a5a;" data-color="#0b7a5a"></div>
                        <div class="single-color-block" style="background-color: #ffd666;" data-color="#ffd666"></div>
                    </div>
                    <div class="single-custom-color" data-area="badmintonLeft">
                        <input type="color" class="single-color-picker" data-area="badmintonLeft" value="#ff9eb1">
                        <span class="single-color-code" data-area="badmintonLeft">#ff9eb1</span>
                    </div>
                </div>

                <div class="area-color-module">
                    <h3 class="module-title" id="badmintonRightTitle">
                        <span></span>
                        右侧区域颜色设置
                    </h3>
                    <div class="single-color-group" data-area="badmintonRight">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block active" style="background-color: #8e77d6;" data-color="#8e77d6"></div>
                        <div class="single-color-block" style="background-color: #327dcd;" data-color="#327dcd"></div>
                        <div class="single-color-block" style="background-color: #d98230;" data-color="#d98230"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #0b7a5a;" data-color="#0b7a5a"></div>
                    </div>
                    <div class="single-custom-color" data-area="badmintonRight">
                        <input type="color" class="single-color-picker" data-area="badmintonRight" value="#8e77d6">
                        <span class="single-color-code" data-area="badmintonRight">#8e77d6</span>
                    </div>
                </div>
            </div>

            <!-- 乒乓球颜色配置模块 -->
            <div class="pingpong-color-modules">
                <div class="area-color-module">
                    <h3 class="module-title" id="pingpongFloorTitle">
                        <span></span>
                        地胶颜色设置
                    </h3>
                    <div class="single-color-group" data-area="pingpongFloor">
                        <!-- 修改：默认选中红色 #d93636 -->
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block active" style="background-color: #d93636;" data-color="#d93636"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                        <div class="single-color-block" style="background-color: #828282;" data-color="#828282"></div>
                    </div>
                    <div class="single-custom-color" data-area="pingpongFloor">
                        <!-- 修改：颜色选择器默认值为 #d93636 -->
                        <input type="color" class="single-color-picker" data-area="pingpongFloor" value="#d93636">
                        <span class="single-color-code" data-area="pingpongFloor">#d93636</span>
                    </div>
                </div>

                <div class="area-color-module">
                    <h3 class="module-title" id="pingpongTableTitle">
                        <span></span>
                        球桌颜色设置
                    </h3>
                    <div class="single-color-group" data-area="pingpongTable">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #8e77d6;" data-color="#8e77d6"></div>
                        <!-- 修改：默认选中蓝色 #2d8cf0 -->
                        <div class="single-color-block active" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                    </div>
                    <div class="single-custom-color" data-area="pingpongTable">
                        <!-- 修改：颜色选择器默认值为 #2d8cf0 -->
                        <input type="color" class="single-color-picker" data-area="pingpongTable" value="#2d8cf0">
                        <span class="single-color-code" data-area="pingpongTable">#2d8cf0</span>
                    </div>
                </div>
            </div>

            <!-- 篮球颜色配置模块 -->
            <div class="basketball-color-modules">
                <div class="area-color-module">
                    <h3 class="module-title" id="basketballBufferTitle">
                        <span></span>
                        缓冲区颜色设置
                    </h3>
                    <div class="single-color-group" data-area="basketballBuffer">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block active" style="background-color: #848d94;" data-color="#848d94"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                    </div>
                    <div class="single-custom-color" data-area="basketballBuffer">
                        <input type="color" class="single-color-picker" data-area="basketballBuffer" value="#848d94">
                        <span class="single-color-code" data-area="basketballBuffer">#848d94</span>
                    </div>
                </div>

                <div class="area-color-module">
                    <h3 class="module-title" id="basketballHomeTitle">
                        <span></span>
                        主场区颜色设置
                    </h3>
                    <div class="single-color-group" data-area="basketballHome">
                        <div class="single-color-block active" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block" style="background-color: #848d94;" data-color="#848d94"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                    </div>
                    <div class="single-custom-color" data-area="basketballHome">
                        <input type="color" class="single-color-picker" data-area="basketballHome" value="#ff9eb1">
                        <span class="single-color-code" data-area="basketballHome">#ff9eb1</span>
                    </div>
                </div>

                <div class="area-color-module">
                    <h3 class="module-title" id="basketballForbiddenTitle">
                        <span></span>
                        禁区颜色设置
                    </h3>
                    <div class="single-color-group" data-area="basketballForbidden">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block" style="background-color: #848d94;" data-color="#848d94"></div>
                        <div class="single-color-block active" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                    </div>
                    <div class="single-custom-color" data-area="basketballForbidden">
                        <input type="color" class="single-color-picker" data-area="basketballForbidden" value="#f53f3f">
                        <span class="single-color-code" data-area="basketballForbidden">#f53f3f</span>
                    </div>
                </div>

                <!-- 新增：三分线颜色配置模块 -->
                <div class="area-color-module">
                    <h3 class="module-title" id="basketballThreePointTitle">
                        <span></span>
                        三分线颜色设置
                    </h3>
                    <div class="single-color-group" data-area="basketballThreePoint">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block" style="background-color: #848d94;" data-color="#848d94"></div>
                        <div class="single-color-block active" style="background-color: #722ed1;" data-color="#722ed1"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                    </div>
                    <div class="single-custom-color" data-area="basketballThreePoint">
                        <input type="color" class="single-color-picker" data-area="basketballThreePoint" value="#722ed1">
                        <span class="single-color-code" data-area="basketballThreePoint">#722ed1</span>
                    </div>
                </div>

                <!-- 新增：半圆区颜色配置模块 -->
                <div class="area-color-module">
                    <h3 class="module-title" id="basketballSemicircleTitle">
                        <span></span>
                        半圆区颜色设置
                    </h3>
                    <div class="single-color-group" data-area="basketballSemicircle">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block" style="background-color: #ff7d00;" data-color="#ff7d00"></div>
                        <div class="single-color-block" style="background-color: #848d94;" data-color="#848d94"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block active" style="background-color: #13c2c2;" data-color="#13c2c2"></div>
                    </div>
                    <div class="single-custom-color" data-area="basketballSemicircle">
                        <input type="color" class="single-color-picker" data-area="basketballSemicircle" value="#13c2c2">
                        <span class="single-color-code" data-area="basketballSemicircle">#13c2c2</span>
                    </div>
                </div>

                <!-- 新增：中圈颜色配置模块 -->
                <div class="area-color-module">
                    <h3 class="module-title" id="basketballCenterCircleTitle">
                        <span></span>
                        中圈颜色设置
                    </h3>
                    <div class="single-color-group" data-area="basketballCenterCircle">
                        <div class="single-color-block" style="background-color: #ff9eb1;" data-color="#ff9eb1"></div>
                        <div class="single-color-block" style="background-color: #2d8cf0;" data-color="#2d8cf0"></div>
                        <div class="single-color-block active" style="background-color: #fa8c16;" data-color="#fa8c16"></div>
                        <div class="single-color-block" style="background-color: #848d94;" data-color="#848d94"></div>
                        <div class="single-color-block" style="background-color: #f53f3f;" data-color="#f53f3f"></div>
                        <div class="single-color-block" style="background-color: #00c48c;" data-color="#00c48c"></div>
                    </div>
                    <div class="single-custom-color" data-area="basketballCenterCircle">
                        <input type="color" class="single-color-picker" data-area="basketballCenterCircle" value="#fa8c16">
                        <span class="single-color-code" data-area="basketballCenterCircle">#fa8c16</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 底部图片上传区域 -->
    <div class="upload-section">
        <h2 class="upload-title">可以找设计要想要的产品色卡上传，然后点击改色面板长条区域里的取色笔选取相应颜色</h2>
        <div class="upload-container">
            <div class="upload-btn-wrapper">
                <button class="upload-btn">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 5V19M12 19L19 12M12 19L5 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    上传参考图片
                </button>
                <input type="file" id="imageUpload" accept="image/*">
            </div>
            <div class="upload-preview">
                <div class="upload-preview-placeholder">
                    上传图片后可在此预览
                </div>
                <img id="previewImage" class="uploaded-image" alt="上传预览">
            </div>
        </div>
    </div>

    <script>
        // 全局变量定义
        const pickleLeftCanvas = document.getElementById('pickleLeftCanvas');
        const pickleRightCanvas = document.getElementById('pickleRightCanvas');
        const pickleBufferCanvas = document.getElementById('pickleBufferCanvas');
        const pickleLeftCtx = pickleLeftCanvas.getContext('2d');
        const pickleRightCtx = pickleRightCanvas.getContext('2d');
        const pickleBufferCtx = pickleBufferCanvas.getContext('2d');

        const badmintonLeftCanvas = document.getElementById('badmintonLeftCanvas');
        const badmintonRightCanvas = document.getElementById('badmintonRightCanvas');
        const badmintonLeftCtx = badmintonLeftCanvas.getContext('2d');
        const badmintonRightCtx = badmintonRightCanvas.getContext('2d');

        const pingpongFloorCanvas = document.getElementById('pingpongFloorCanvas');
        const pingpongTableCanvas = document.getElementById('pingpongTableCanvas');
        const pingpongFloorCtx = pingpongFloorCanvas.getContext('2d');
        const pingpongTableCtx = pingpongTableCanvas.getContext('2d');

        // 篮球Canvas元素
        const basketballBufferCanvas = document.getElementById('basketballBufferCanvas');
        const basketballHomeCanvas = document.getElementById('basketballHomeCanvas');
        const basketballForbiddenCanvas = document.getElementById('basketballForbiddenCanvas');
        const basketballBufferCtx = basketballBufferCanvas.getContext('2d');
        const basketballHomeCtx = basketballHomeCanvas.getContext('2d');
        const basketballForbiddenCtx = basketballForbiddenCanvas.getContext('2d');
        
        // 新增：三个篮球区域Canvas元素
        const basketballThreePointCanvas = document.getElementById('basketballThreePointCanvas');
        const basketballSemicircleCanvas = document.getElementById('basketballSemicircleCanvas');
        const basketballCenterCircleCanvas = document.getElementById('basketballCenterCircleCanvas');
        const basketballThreePointCtx = basketballThreePointCanvas.getContext('2d');
        const basketballSemicircleCtx = basketballSemicircleCanvas.getContext('2d');
        const basketballCenterCircleCtx = basketballCenterCircleCanvas.getContext('2d');

        // 图片上传相关变量
        const imageUpload = document.getElementById('imageUpload');
        const previewImage = document.getElementById('previewImage');
        const previewPlaceholder = document.querySelector('.upload-preview-placeholder');
        
        let currentActiveArea = 'pickleLeft'; // 默认当前激活的颜色区域

        // 图片路径配置
        const imgConfig = {
            pickle: {
                bg: 'https://s41.ax1x.com/2026/01/03/pZUwrTI.png',
                left: 'https://s41.ax1x.com/2026/01/03/pZUwwOH.png',
                right: 'https://s1.img-e.com/20260105/695bdb5c187df.png',
                buffer: 'https://s41.ax1x.com/2026/01/03/pZUwD0A.png'
            },
            badminton: {
                bg: 'https://s41.ax1x.com/2026/01/08/pZwWass.png',
                left: 'https://s41.ax1x.com/2026/01/08/pZwW3If.png',
                right: 'https://s41.ax1x.com/2026/01/08/pZwfpY8.png'
            },
            pingpong: {
                bg: 'https://s41.ax1x.com/2026/01/11/pZ0jzIU.png',
                floor: 'https://s41.ax1x.com/2026/01/11/pZ0jxaT.png',
                table: 'https://s41.ax1x.com/2026/01/11/pZ0jvZV.png'
            },
            basketball: {
                bg: 'https://youke3.picui.cn/s1/2026/01/11/69636ce939c99.png',
                buffer: 'https://s41.ax1x.com/2026/01/11/pZ0zxdP.png',
                home: 'https://youke3.picui.cn/s1/2026/01/11/69636ce935367.png',
                forbidden: 'https://s41.ax1x.com/2026/01/11/pZ0zOsA.png',
                threePoint: 'https://s41.ax1x.com/2026/01/11/pZ0zLMd.png', // 新增：三分线
                semicircle: 'https://s41.ax1x.com/2026/01/11/pZ0zbxH.png', // 新增：半圆区
                centerCircle: 'https://s41.ax1x.com/2026/01/11/pZ0zXqI.png' // 新增：中圈
            }
        };

        // 图片对象存储
        const imgObjects = {
            pickle: { left: new Image(), right: new Image(), buffer: new Image() },
            badminton: { left: new Image(), right: new Image() },
            pingpong: { floor: new Image(), table: new Image() },
            basketball: { 
                buffer: new Image(), 
                home: new Image(), 
                forbidden: new Image(),
                threePoint: new Image(), // 新增：三分线
                semicircle: new Image(), // 新增：半圆区
                centerCircle: new Image() // 新增：中圈
            }
        };

        let bgImgWidth = 800;
        let bgImgHeight = 600;
        let currentCourtType = 'pickle';

        function initAllImages() {
            const pickleBgImg = new Image();
            pickleBgImg.onload = function() {
                bgImgWidth = this.width;
                bgImgHeight = this.height;
                [pickleLeftCanvas, pickleRightCanvas, pickleBufferCanvas,
                 badmintonLeftCanvas, badmintonRightCanvas,
                 pingpongFloorCanvas, pingpongTableCanvas,
                 basketballBufferCanvas, basketballHomeCanvas, basketballForbiddenCanvas,
                 basketballThreePointCanvas, basketballSemicircleCanvas, basketballCenterCircleCanvas].forEach(canvas => { // 新增：三个篮球Canvas
                    canvas.width = bgImgWidth;
                    canvas.height = bgImgHeight;
                });
                loadPickleImages();
                loadPingpongImages();
                loadBasketballImages();
            };
            pickleBgImg.src = imgConfig.pickle.bg;

            // 加载羽毛球图片
            imgObjects.badminton.left.src = imgConfig.badminton.left;
            imgObjects.badminton.right.src = imgConfig.badminton.right;
        }

        function loadPickleImages() {
            let pickleImgLoadCount = 0;
            function pickleImgLoaded() {
                pickleImgLoadCount++;
                if (pickleImgLoadCount === 3) {
                    renderArea('pickle', 'left', '#ff9eb1');
                    renderArea('pickle', 'right', '#8e77d6');
                    renderArea('pickle', 'buffer', '#848d94');
                }
            }

            imgObjects.pickle.left.onload = pickleImgLoaded;
            imgObjects.pickle.left.src = imgConfig.pickle.left;
            imgObjects.pickle.right.onload = pickleImgLoaded;
            imgObjects.pickle.right.src = imgConfig.pickle.right;
            imgObjects.pickle.buffer.onload = pickleImgLoaded;
            imgObjects.pickle.buffer.src = imgConfig.pickle.buffer;
        }

        function loadPingpongImages() {
            imgObjects.pingpong.floor.onload = function() {};
            imgObjects.pingpong.floor.src = imgConfig.pingpong.floor;
            
            imgObjects.pingpong.table.onload = function() {};
            imgObjects.pingpong.table.src = imgConfig.pingpong.table;
        }

        // 加载篮球图片
        function loadBasketballImages() {
            let basketballImgLoadCount = 0;
            function basketballImgLoaded() {
                basketballImgLoadCount++;
                if (basketballImgLoadCount === 6) { // 修改：从3改为6，包含新增的三个区域
                    // 初始化篮球各区域颜色
                    renderArea('basketball', 'buffer', '#848d94');
                    renderArea('basketball', 'home', '#ff9eb1');
                    renderArea('basketball', 'forbidden', '#f53f3f');
                    // 新增：初始化三个区域的默认颜色
                    renderArea('basketball', 'threePoint', '#722ed1');
                    renderArea('basketball', 'semicircle', '#13c2c2');
                    renderArea('basketball', 'centerCircle', '#fa8c16');
                }
            }

            imgObjects.basketball.buffer.onload = basketballImgLoaded;
            imgObjects.basketball.buffer.src = imgConfig.basketball.buffer;
            imgObjects.basketball.home.onload = basketballImgLoaded;
            imgObjects.basketball.home.src = imgConfig.basketball.home;
            imgObjects.basketball.forbidden.onload = basketballImgLoaded;
            imgObjects.basketball.forbidden.src = imgConfig.basketball.forbidden;
            // 新增：加载三个区域的图片
            imgObjects.basketball.threePoint.onload = basketballImgLoaded;
            imgObjects.basketball.threePoint.src = imgConfig.basketball.threePoint;
            imgObjects.basketball.semicircle.onload = basketballImgLoaded;
            imgObjects.basketball.semicircle.src = imgConfig.basketball.semicircle;
            imgObjects.basketball.centerCircle.onload = basketballImgLoaded;
            imgObjects.basketball.centerCircle.src = imgConfig.basketball.centerCircle;
        }

        // 通用渲染函数
        function renderArea(courtType, areaType, targetColor) {
            let ctx, img;
            if (courtType === 'pickle') {
                switch (areaType) {
                    case 'left': ctx = pickleLeftCtx; img = imgObjects.pickle.left; break;
                    case 'right': ctx = pickleRightCtx; img = imgObjects.pickle.right; break;
                    case 'buffer': ctx = pickleBufferCtx; img = imgObjects.pickle.buffer; break;
                    default: return;
                }
            } else if (courtType === 'badminton') {
                switch (areaType) {
                    case 'left': ctx = badmintonLeftCtx; img = imgObjects.badminton.left; break;
                    case 'right': ctx = badmintonRightCtx; img = imgObjects.badminton.right; break;
                    default: return;
                }
            } else if (courtType === 'pingpong') {
                switch (areaType) {
                    case 'floor': ctx = pingpongFloorCtx; img = imgObjects.pingpong.floor; break;
                    case 'table': ctx = pingpongTableCtx; img = imgObjects.pingpong.table; break;
                    default: return;
                }
            } else if (courtType === 'basketball') {
                switch (areaType) {
                    case 'buffer': ctx = basketballBufferCtx; img = imgObjects.basketball.buffer; break;
                    case 'home': ctx = basketballHomeCtx; img = imgObjects.basketball.home; break;
                    case 'forbidden': ctx = basketballForbiddenCtx; img = imgObjects.basketball.forbidden; break;
                    case 'threePoint': ctx = basketballThreePointCtx; img = imgObjects.basketball.threePoint; break; // 新增：三分线
                    case 'semicircle': ctx = basketballSemicircleCtx; img = imgObjects.basketball.semicircle; break; // 新增：半圆区
                    case 'centerCircle': ctx = basketballCenterCircleCtx; img = imgObjects.basketball.centerCircle; break; // 新增：中圈
                    default: return;
                }
            } else {
                return;
            }

            ctx.clearRect(0, 0, bgImgWidth, bgImgHeight);
            const drawX = 0;
            const drawY = 0;
            const drawWidth = bgImgWidth;
            const drawHeight = bgImgHeight;

            if (img.complete) {
                ctx.drawImage(img, drawX, drawY, drawWidth, drawHeight);
                ctx.globalCompositeOperation = 'source-in';
                ctx.fillStyle = targetColor;
                ctx.fillRect(drawX, drawY, drawWidth, drawHeight);
                ctx.globalCompositeOperation = 'source-over';
            }
        }

        function updateColorCodeDisplay(areaKey, color) {
            const colorCodeEl = document.querySelector(`.single-color-code[data-area="${areaKey}"]`);
            if (colorCodeEl) colorCodeEl.textContent = color;
        }

        // 场地类型切换逻辑
        function switchCourtType(type) {
            currentCourtType = type;
            // 切换按钮激活状态
            document.querySelectorAll('.switch-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });

            // 切换背景图
            const courtBg = document.querySelector('.court-bg');
            courtBg.style.backgroundImage = `url('${imgConfig[type].bg}')`;

            // 隐藏所有Canvas
            [pickleLeftCanvas, pickleRightCanvas, pickleBufferCanvas,
             badmintonLeftCanvas, badmintonRightCanvas,
             pingpongFloorCanvas, pingpongTableCanvas,
             basketballBufferCanvas, basketballHomeCanvas, basketballForbiddenCanvas,
             basketballThreePointCanvas, basketballSemicircleCanvas, basketballCenterCircleCanvas].forEach(canvas => { // 新增：三个篮球Canvas
                canvas.style.display = 'none';
            });

            // 隐藏所有颜色模块
            document.querySelector('.pickle-color-modules').style.display = 'none';
            document.querySelector('.badminton-color-modules').style.display = 'none';
            document.querySelector('.pingpong-color-modules').style.display = 'none';
            document.querySelector('.basketball-color-modules').style.display = 'none';

            // 根据类型显示对应Canvas和模块
            if (type === 'pickle') {
                pickleLeftCanvas.style.display = 'block';
                pickleRightCanvas.style.display = 'block';
                pickleBufferCanvas.style.display = 'block';
                document.querySelector('.pickle-color-modules').style.display = 'block';
                // 重新渲染匹克球区域
                renderArea('pickle', 'left', document.querySelector('.single-color-picker[data-area="pickleLeft"]').value);
                renderArea('pickle', 'right', document.querySelector('.single-color-picker[data-area="pickleRight"]').value);
                renderArea('pickle', 'buffer', document.querySelector('.single-color-picker[data-area="pickleBuffer"]').value);
                // 更新当前激活区域
                currentActiveArea = 'pickleLeft';
            } else if (type === 'badminton') {
                badmintonLeftCanvas.style.display = 'block';
                badmintonRightCanvas.style.display = 'block';
                document.querySelector('.badminton-color-modules').style.display = 'block';
                // 渲染羽毛球区域
                renderArea('badminton', 'left', document.querySelector('.single-color-picker[data-area="badmintonLeft"]').value);
                renderArea('badminton', 'right', document.querySelector('.single-color-picker[data-area="badmintonRight"]').value);
                // 更新当前激活区域
                currentActiveArea = 'badmintonLeft';
            } else if (type === 'pingpong') {
                pingpongFloorCanvas.style.display = 'block';
                pingpongTableCanvas.style.display = 'block';
                document.querySelector('.pingpong-color-modules').style.display = 'block';
                // 渲染乒乓球区域 - 使用新的默认颜色
                renderArea('pingpong', 'floor', document.querySelector('.single-color-picker[data-area="pingpongFloor"]').value);
                renderArea('pingpong', 'table', document.querySelector('.single-color-picker[data-area="pingpongTable"]').value);
                // 更新当前激活区域
                currentActiveArea = 'pingpongFloor';
            } else if (type === 'basketball') {
                // 显示篮球所有Canvas
                basketballBufferCanvas.style.display = 'block';
                basketballHomeCanvas.style.display = 'block';
                basketballForbiddenCanvas.style.display = 'block';
                // 新增：显示三个篮球区域Canvas
                basketballThreePointCanvas.style.display = 'block';
                basketballSemicircleCanvas.style.display = 'block';
                basketballCenterCircleCanvas.style.display = 'block';
                
                document.querySelector('.basketball-color-modules').style.display = 'block';
                // 渲染篮球区域
                renderArea('basketball', 'buffer', document.querySelector('.single-color-picker[data-area="basketballBuffer"]').value);
                renderArea('basketball', 'home', document.querySelector('.single-color-picker[data-area="basketballHome"]').value);
                renderArea('basketball', 'forbidden', document.querySelector('.single-color-picker[data-area="basketballForbidden"]').value);
                // 新增：渲染三个篮球区域
                renderArea('basketball', 'threePoint', document.querySelector('.single-color-picker[data-area="basketballThreePoint"]').value);
                renderArea('basketball', 'semicircle', document.querySelector('.single-color-picker[data-area="basketballSemicircle"]').value);
                renderArea('basketball', 'centerCircle', document.querySelector('.single-color-picker[data-area="basketballCenterCircle"]').value);
                
                // 更新当前激活区域
                currentActiveArea = 'basketballBuffer';
            }
        }

        // 绑定场地切换事件
        document.querySelectorAll('.switch-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                switchCourtType(this.dataset.type);
            });
        });

        // 绑定预设颜色选择事件
        document.querySelectorAll('.single-color-block').forEach(block => {
            block.addEventListener('click', function() {
                const areaKey = this.parentElement.dataset.area;
                this.parentElement.querySelectorAll('.single-color-block').forEach(item => item.classList.remove('active'));
                this.classList.add('active');
                const color = this.dataset.color;
                document.querySelector(`.single-color-picker[data-area="${areaKey}"]`).value = color;
                updateColorCodeDisplay(areaKey, color);
                
                // 更新当前激活区域
                currentActiveArea = areaKey;

                // 解析场地类型和区域类型并渲染 - 修复核心逻辑
                let courtType, areaType;
                if (areaKey.startsWith('pickle')) {
                    courtType = 'pickle';
                    areaType = areaKey.replace('pickle', '').toLowerCase();
                } else if (areaKey.startsWith('badminton')) {
                    courtType = 'badminton';
                    areaType = areaKey.replace('badminton', '').toLowerCase();
                } else if (areaKey.startsWith('pingpong')) {
                    courtType = 'pingpong';
                    areaType = areaKey.replace('pingpong', '').toLowerCase();
                } else if (areaKey.startsWith('basketball')) {
                    courtType = 'basketball';
                    // 修复：处理大小写和命名匹配问题
                    areaType = areaKey.replace('basketball', '');
                    // 将首字母小写，处理ThreePoint -> threePoint的情况
                    if (areaType.length > 0) {
                        areaType = areaType.charAt(0).toLowerCase() + areaType.slice(1);
                    }
                }
                
                // 执行渲染
                if (courtType && areaType) {
                    renderArea(courtType, areaType, color);
                }
            });
        });

        // 绑定自定义颜色选择事件
        document.querySelectorAll('.single-color-picker').forEach(picker => {
            picker.addEventListener('input', function() {
                const areaKey = this.dataset.area;
                const color = this.value;
                updateColorCodeDisplay(areaKey, color);
                document.querySelectorAll(`.single-color-group[data-area="${areaKey}"] .single-color-block`).forEach(block => block.classList.remove('active'));
                
                // 更新当前激活区域
                currentActiveArea = areaKey;

                // 解析场地类型和区域类型并渲染 - 修复核心逻辑
                let courtType, areaType;
                if (areaKey.startsWith('pickle')) {
                    courtType = 'pickle';
                    areaType = areaKey.replace('pickle', '').toLowerCase();
                } else if (areaKey.startsWith('badminton')) {
                    courtType = 'badminton';
                    areaType = areaKey.replace('badminton', '').toLowerCase();
                } else if (areaKey.startsWith('pingpong')) {
                    courtType = 'pingpong';
                    areaType = areaKey.replace('pingpong', '').toLowerCase();
                } else if (areaKey.startsWith('basketball')) {
                    courtType = 'basketball';
                    // 修复：处理大小写和命名匹配问题
                    areaType = areaKey.replace('basketball', '');
                    // 将首字母小写，处理ThreePoint -> threePoint的情况
                    if (areaType.length > 0) {
                        areaType = areaType.charAt(0).toLowerCase() + areaType.slice(1);
                    }
                }
                
                // 执行渲染
                if (courtType && areaType) {
                    renderArea(courtType, areaType, color);
                }
            });
        });

        // 图片上传功能
        imageUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                previewImage.src = event.target.result;
                previewImage.onload = function() {
                    // 显示预览图片，隐藏占位符
                    previewPlaceholder.style.display = 'none';
                    previewImage.style.display = 'block';
                };
            };
            reader.readAsDataURL(file);
        });

        window.addEventListener('load', function() {
            initAllImages();
            const courtContainer = document.querySelector('.court-container');
            function resizeCanvas() {
                [pickleLeftCanvas, pickleRightCanvas, pickleBufferCanvas,
                 badmintonLeftCanvas, badmintonRightCanvas,
                 pingpongFloorCanvas, pingpongTableCanvas,
                 basketballBufferCanvas, basketballHomeCanvas, basketballForbiddenCanvas,
                 basketballThreePointCanvas, basketballSemicircleCanvas, basketballCenterCircleCanvas].forEach(canvas => { // 新增：三个篮球Canvas
                    canvas.style.width = '100%';
                    canvas.style.height = '100%';
                });
            }
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
        });
    </script>
</body>
</html>
